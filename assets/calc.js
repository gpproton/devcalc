function init(){isTouchSupported="ontouchstart"in window,START_EVENT=isTouchSupported?"touchstart":"mousedown",MOVE_EVENT=isTouchSupported?"touchmove":"mousemove",END_EVENT=isTouchSupported?"touchend":"mouseup",prepareGraphics(),updateNumfields(),$("#pub_url")[0].value=getShareURL(),$("input#pub_url_copy").zclip({path:"js/ZeroClipboard.swf",copy:function(){return $("input#pub_url").val()}}),$(document).keydown(function(t){t=t||window.event;var e=t.keyCode;96==e||48==e?$("#btn_num_0").trigger(START_EVENT):97==e||49==e?$("#btn_num_1").trigger(START_EVENT):98==e||50==e?$("#btn_num_2").trigger(START_EVENT):99==e||51==e?$("#btn_num_3").trigger(START_EVENT):100==e||52==e?$("#btn_num_4").trigger(START_EVENT):101==e||53==e?$("#btn_num_5").trigger(START_EVENT):102==e||54==e?$("#btn_num_6").trigger(START_EVENT):103==e||55==e?$("#btn_num_7").trigger(START_EVENT):104==e||56==e&&!t.shiftKey?$("#btn_num_8").trigger(START_EVENT):t.shiftKey&&56==e?$("#btn_fun_mul").trigger(START_EVENT):105==e||57==e?$("#btn_num_9").trigger(START_EVENT):65==e?$("#btn_num_a").trigger(START_EVENT):66==e?$("#btn_num_b").trigger(START_EVENT):67==e?$("#btn_num_c").trigger(START_EVENT):68==e?$("#btn_num_d").trigger(START_EVENT):69==e?$("#btn_num_e").trigger(START_EVENT):70==e?$("#btn_num_f").trigger(START_EVENT):106==e?$("#btn_fun_mul").trigger(START_EVENT):107==e||187==e?$("#btn_fun_plu").trigger(START_EVENT):109==e||189==e?$("#btn_fun_dif").trigger(START_EVENT):111==e||191==e?$("#btn_fun_div").trigger(START_EVENT):13==e&&$("#btn_fun_eq").trigger(START_EVENT)}),$(document).keyup(function(t){var e=t.keyCode;96==e||48==e?$("#btn_num_0").trigger(END_EVENT):97==e||49==e?$("#btn_num_1").trigger(END_EVENT):98==e||50==e?$("#btn_num_2").trigger(END_EVENT):99==e||51==e?$("#btn_num_3").trigger(END_EVENT):100==e||52==e?$("#btn_num_4").trigger(END_EVENT):101==e||53==e?$("#btn_num_5").trigger(END_EVENT):102==e||54==e?$("#btn_num_6").trigger(END_EVENT):103==e||55==e?$("#btn_num_7").trigger(END_EVENT):104==e||56==e&&!t.shiftKey?$("#btn_num_8").trigger(END_EVENT):t.shiftKey&&56==e?$("#btn_fun_mul").trigger(END_EVENT):105==e||57==e?$("#btn_num_9").trigger(END_EVENT):65==e?$("#btn_num_a").trigger(END_EVENT):66==e?$("#btn_num_b").trigger(END_EVENT):67==e?$("#btn_num_c").trigger(END_EVENT):68==e?$("#btn_num_d").trigger(END_EVENT):69==e?$("#btn_num_e").trigger(END_EVENT):70==e?$("#btn_num_f").trigger(END_EVENT):106==e?$("#btn_fun_mul").trigger(END_EVENT):107==e||187==e?$("#btn_fun_plu").trigger(END_EVENT):109==e||189==e?$("#btn_fun_dif").trigger(END_EVENT):111==e||191==e?$("#btn_fun_div").trigger(END_EVENT):13==e&&$("#btn_fun_eq").trigger(END_EVENT)})}function mobileOrientation(){var t,e=$(window).height(),s=$(window).width();return t=e>s?!0:!1}function prepareGraphics(){var t=0;calcwidth=Math.min($(window).width()-20,960);var e;$("#gglad, #gglad_m").css("display","none"),1==mobileOrientation()?(e=$(window).height()-50,calcwidth=$(window).width(),$("#container").css("top","-80px").css("left","-20px"),$(".footernav").css("visibility","hidden")):e=Math.min($(window).height(),600);var s=new Image;s.src="img/ui/regular/calc_bg.png",s.onload=function(){$("#calc_container").css("width",calcwidth+"px").css("height",e+"px"),$(".footernav").css("width",calcwidth+"px"),t++};var n=new Image;n.src="img/ui/regular/numfield.png";var a=calcwidth+$("#calc_container").position().left,i=e+$("#calc_container").position().top;n.onload=function(){var t=Math.floor(calcwidth-180),s=Math.floor(.061*e),n=Math.floor(calcwidth-t-60);$("#numfield_dec, .bignumfield").css("width",t+"px"),$("#numfield_hex, #numfield_float").css("width",Math.ceil(t/2)-1+"px").css("font-size",Math.floor(.4*s)+"px"),$(".numfiled_span").css("margin-right","20px"),$(".numfield").css("line-height",s+"px").css("font-size",Math.floor(.6*s)+"px"),$("#textfield_ascii").css("font-size",Math.floor(.4*s)+"px").css("position","relative").css("top","-"+Math.floor(.7*s)+"px"),$(".numfield, .ascfield").css("height",s+"px"),$(".bignumfield").css("height",2*s+"px"),$(".ascfield").css("width",n+"px"),$(".popwind").css("width",calcwidth-50+"px").css("height",e-4*s-40+"px").css("top",4*s+20+"px").css("left","25px"),$("#memlines").css("height",e-4*s-40-Math.floor(.115*e)+"px"),$("#history_control").css("left",a+"px"),$(".footerlink").css("top",i+20+"px").css("left",$("#calc_container").position().left+"px").css("width",$("#calc_container").width()+"px")};var r=new Image;r.src="img/ui/regular/button_idle.png";var o=7,c=Math.floor(.13*calcwidth)-o,l=Math.floor(.115*e)-o;r.onload=function(){btn_images.idle="url("+draw9Scale(r,23,19,23,19,c,l).src+")",btn_images.p_idle="url("+draw9Scale(r,23,19,23,19,c,Math.floor(1.6*l)).src+")",btn_images.e_idle="url("+draw9Scale(r,23,19,23,19,2*c,l).src+")",$("#numblock, #cmdblock").css("width",Math.floor(.4*calcwidth)+"px"),$("#memblock").css("width",c+"px").css("left",Math.floor(.5*calcwidth-.5*c)+"px"),$("#numblock, #cmdblock").css("top",Math.floor(.28*e)+"px"),$("#numblock, #cmdblock, #memblock, #memcmd").css("line-height",l+"px"),$(".std_btn, .plus_btn").css("width",c+"px"),$(".std_btn, .eq_btn").css("height",l+"px"),$(".std_btn, .eq_btn, .plus_btn").css("margin-right",o+"px").css("margin-bottom",o+"px"),$(".eq_btn").css("width",2*c+o+"px"),$(".plus_btn").css("height",Math.floor(1.6*l)+"px").css("line-height",Math.floor(1.6*l)+"px"),$(".btext").css("height",l+"px"),$("#numblock, #memblock").css("font-size",Math.floor(.4*l)+"px"),$("#cmdblock").css("font-size",Math.floor(.3*l)+"px");var t=.12*($("#binwind").height()-80);$(".bitswitch_btn").css("height",t);$("#numfield_bin").position(),$("#numfield_bin").width(),$("#numfield_bin").height()};var u=new Image;for(u.src="img/ui/regular/button_press.png",u.onload=function(){btn_images.press="url("+draw9Scale(u,23,19,23,19,c,l).src+")",btn_images.p_press="url("+draw9Scale(u,23,19,23,19,c,Math.floor(1.6*l)).src+")",btn_images.e_press="url("+draw9Scale(u,23,19,23,19,2*c,l).src+")",$(".std_btn").on(START_EVENT,function(t){$(t.currentTarget).css("line-height",l+2+"px")}),$(".std_btn").on("mouseup mouseout",function(t){$(t.currentTarget).css("line-height",l+"px")}),$(".bitswitch_btn").on(START_EVENT,function(t){var e=t.currentTarget;btn_id=e.id,btn_id=btn_id.replace("bitswbtn",""),bitSwitchClick(btn_id)}).on(END_EVENT+" mouseup mouseout",function(){}),$(".std_btn").css("line-height",l+"px")},$(".reg_btn").on(END_EVENT,function(t){buttonPress(t)}),$("#bit_switcher").on(END_EVENT,function(){state.bitSelect?($("#bit_switcher").css("background-position","0px 0px"),$("#bitlist").css("visibility","hidden"),state.bitSelect=!1):($("#bit_switcher").css("background-position","0px 45px"),$("#bitlist").css("visibility","visible"),state.bitSelect=!0)}),$("#inp_switcher").on(END_EVENT,function(){state.inpSelect?($("#inp_switcher").css("background-position","0px 0px"),$("#inplist").css("visibility","hidden"),state.inpSelect=!1):($("#inp_switcher").css("background-position","0px 45px"),$("#inplist").css("visibility","visible"),state.inpSelect=!0)}),$("#type_switcher").on(END_EVENT,function(){state.typeSelect?($("#type_switcher").css("background-position","0px 0px"),$("#typelist").css("visibility","hidden"),state.typeSelect=!1):($("#type_switcher").css("background-position","0px 45px"),$("#typelist").css("visibility","visible"),state.typeSelect=!0)}),$("#sign_switcher").on("click",function(){state.signed?(switchSigned(!1),recordCommand("s_uns")):(switchSigned(!0),recordCommand("s_sig"))}).css("background-position","0px 45px").css("text-align","left"),$("#sign_switcher_txt").html("Signed"),$("#numfield_dec").on("click",function(){setInput("dec"),recordCommand("s_dec")}),$("#numfield_hex").on("click",function(){setInput("hex"),recordCommand("s_hex")}),$("#numfield_bin").on("click",function(){openBitSwitcher()}),p=0;p<available_bits.length;p++)$("#bitlist").append("<div id='bitlist_element_"+p+"' class='bitlist_element list_element'>"+available_bits[p]+" bit</div>");for(p=0;p<available_types.length;p++)$("#typelist").append("<div id='typelist_element_"+p+"' class='typelist_element list_element'>"+available_types[p]+"</div>");for(p=0;p<available_inps.length;p++)$("#inplist").append("<div id='inplist_element_"+p+"' class='inplist_element list_element'>"+available_inps[p]+"</div>");$(".bitlist_element").on(END_EVENT,function(t){bitlistClick(t)}),$(".inplist_element").on(END_EVENT,function(t){inplistClick(t)}),$(".typelist_element").on(END_EVENT,function(t){typelistClick(t)}),$("#history_undo").on(END_EVENT,function(){undo()}),$("#history_redo").on(END_EVENT,function(){redo()}),$("#history_clear").on(END_EVENT,function(){clearHistoy()}),$("#numfield_bin").mouseenter(function(){$("#popping_hint").css("display","block")}).mouseleave(function(){$("#popping_hint").css("display","none")}),$("#numfield_float").mouseenter(function(){$("#popping_hint2").css("display","block")}).mouseleave(function(){$("#popping_hint2").css("display","none")}),$(".bitswitch_btn").mouseenter(function(t){var e=$(t.currentTarget);e.hasClass("mantissa")?($("#bithint1").css("display","none"),$("#bithint2").css("display","block"),$("#bithint3").css("display","none")):e.hasClass("sign")&&($("#bithint1").css("display","none"),$("#bithint2").css("display","none"),$("#bithint3").css("display","block"))}).mouseleave(function(){$("#bithint1").css("display","block"),$("#bithint2").css("display","none"),$("#bithint3").css("display","none")}),clearConsoleMemo();var d=getParameterByName("s");state.cmdURL=d;for(var p=0;p<d.length;p++)runChar(d.charAt(p));logConsoleMemo(),checkFloatHint()}function checkFloatHint(){$(".bitswitch_btn").removeClass("mantissa sign");var t,e;16==state.bitlength?(t=10,e=5):32==state.bitlength?(t=23,e=8):64==state.bitlength&&(t=52,e=11);for(var s=0;s<state.bitlength;s++){var n=state.bitlength-s-1;0==n?$("#bitswbtn"+s).addClass("sign"):n>0&&e>=n&&$("#bitswbtn"+s).addClass("mantissa")}}function bitlistClick(t){var e=t.currentTarget.id.split("_");$("#bitlist").css("visibility","hidden");var s=parseInt(e.pop());switchBitlenght(s),recordCommand("s_"+available_bits[s])}function inplistClick(t){var e=t.currentTarget.id.split("_");$("#inplist").css("visibility","hidden");var s=parseInt(e.pop());switchInpType(s),recordCommand("s_"+available_inps[s])}function typelistClick(t){var e=t.currentTarget.id.split("_");$("#typelist").css("visibility","hidden");var s=parseInt(e.pop());switchTypeType(s),recordCommand("s_"+available_types[s])}function draw9Scale(t,e,s,n,a,i,r){var o=t.width,c=t.height,l=document.createElement("canvas");l.width=i,l.height=r;var u=l.getContext("2d");u.drawImage(t,0,0,s,e,0,0,s,e),u.drawImage(t,s,0,o-(a+s),e,s,0,i-(s+a),e),u.drawImage(t,o-a,0,a,e,i-a,0,a,e),u.drawImage(t,0,e,s,c-(e+n),0,e,s,r-(n+e)),u.drawImage(t,s,e,o-(a+s),c-(e+n),s,e,i-(a+s),r-(e+n)),u.drawImage(t,o-a,e,a,c-(e+n),i-a,e,a,r-(e+n)),u.drawImage(t,0,c-n,s,n,0,r-n,s,n),u.drawImage(t,s,c-n,o-(s+a),n,s,r-n,i-(s+a),n),u.drawImage(t,o-a,c-n,a,n,i-a,r-n,a,n);var d=new Image;return d.src=l.toDataURL(),u=null,l=null,d}function numberPress(t){if("dec"==state.input)if(1==state.isfloat){if(-1!=state.curdec.lastIndexOf("e")){var e=state.curdec.split("e");state.curdec=e[0]+t+"e"+e[1]}else state.curdec=state.curdec.concat(t);setCurrent(state.curdec,1)}else state.curdec=state.curdec.concat(t),setCurrent(state.curdec,10);else"hex"==state.input?(state.curhex=state.curhex.concat(t),setCurrent(state.curhex,16)):"bin"==state.input&&(state.curbin=state.curbin.concat(t),setCurrent(state.curbin,2));updateLastMemo(),updateNumfields()}function dotPress(){"dec"==state.input&&1==state.isfloat&&-1==state.curdec.lastIndexOf(".")&&(state.curdec=state.curdec.concat("."))}function updateLastMemo(){var t=console_memo[console_memo.length-1];"hex"==t.type||"bin"==t.type||"dec"==t.type?console_memo[console_memo.length-1]={type:state.input,value:state["cur"+state.input]}:"eq"==t.type?(console.log("that the situation"),clearConsoleMemo()):(t.oncurrent&&clearConsoleMemo(),console_memo.push({type:state.input,value:state["cur"+state.input]})),console.log(console_memo)}function bitSwitchClick(t){for(var e="",s=0;64>s;s++){var n=$("#bitswbtn"+s+"> .bitswitch_glyph");e=t==s?"0"==n.html()?"1"+e:"0"+e:n.html()+e}setCurrent(e,"2"),updateLastMemo(),updateNumfields()}function buttonPress(t){var e=t.currentTarget.id.split("_");e.shift(),"num"==e[0]?(runCommand("n_"+e[1]),recordCommand("n_"+e[1])):"fun"==e[0]?(runCommand("c_"+e[1]),recordCommand("c_"+e[1])):alert("ERROR!"),logConsoleMemo()}function runChar(t){for(var e=sCmdPairs.length,s=0;e>s&&sCmdPairs[s].symb!=t;s++);e-1>s&&runCommand(sCmdPairs[s].cmd)}function runCommand(t,e){if(e="undefined"!=typeof e?e:!1,params=t.split("_"),"n"==params[0])parseInt(params[1],16)<state.base&&numberPress(params[1]);else if("c"==params[0])switch(params[1]){case"ce":console_memo.pop(),setCurrent("0",10),updateNumfields();break;case"ca":setCurrent("0"),clearConsoleMemo(),state.curcmd="",updateNumfields();break;case"mod":case"xly":case"xry":case"and":case"or":case"xor":case"nnd":case"nor":case"xnr":case"div":case"mul":case"dif":case"plu":stackCommand(params[1]);break;case"bak":case"plm":case"rol":case"ror":case"lsh":case"rsh":case"not":executeCommand(params[1]);break;case"eq":equall();break;case"mem":openMemory();break;case"mad":addCurrentToMem();break;case"mcl":closeMemory();break;case"clm":memoryNumbers=[],updateMemory();break;case"bcl":closeBitSwitcher();break;case"dot":dotPress()}else"s"==params[0]?("sig"==params[1]&&switchSigned(!0),"uns"==params[1]&&switchSigned(!1),"8"==params[1]&&switchBitlenght(0),"16"==params[1]&&switchBitlenght(1),"32"==params[1]&&switchBitlenght(2),"64"==params[1]&&switchBitlenght(3),"128"==params[1]&&switchBitlenght(4),"hex"==params[1]&&switchInpType(0),"dec"==params[1]&&switchInpType(1),"bin"==params[1]&&switchInpType(2)):"a"==params[0];1==e&&updateNumfields()}function recordCommand(t){for(var e=sCmdPairs.length,s=0;e>s&&sCmdPairs[s].cmd!=t;s++);e-1>s&&(state.cmdURL+=sCmdPairs[s].symb,state.cmdURLBak="",state.undosteps=0),$("#pub_url")[0].value=getShareURL()}function undo(){if(restoreDefaults(),updateNumfields(),""!=state.cmdURL){0==state.undosteps&&(state.cmdURLBak=state.cmdURL.toString()),state.cmdURL=state.cmdURL.slice(0,-1);for(var t=0;t<state.cmdURL.length;t++)runChar(state.cmdURL.charAt(t));state.undosteps++}logConsoleMemo(),$("#pub_url")[0].value=getShareURL()}function redo(){state.cmdURL.length<state.cmdURLBak.length&&(runChar(state.cmdURLBak.charAt(state.cmdURL.length)),state.cmdURL+=state.cmdURLBak.charAt(state.cmdURL.length),state.undosteps--),logConsoleMemo(),$("#pub_url")[0].value=getShareURL()}function restoreDefaults(){memoryNumbers=[],clearConsoleMemo(),state.input="hex",state.base=16,state.bitlength=64,state.numberX=new BigInteger("0",10),state.operandA=new BigInteger("0",10),state.operandB=new BigInteger("0",10),state.floatHex=new BigInteger("0",10),state.fnumberX=new BigInteger("0.0"),state.foperandA=new BigInteger("0.0"),state.foperandB=new BigInteger("0.0"),state.signed=!0,state.curdec="0",state.curhex="0",state.curbin="0",state.curfloat="0",state.curdec="0",state.curcmd="",state.prevcmd="",state.bitSelect=!1,switchSigned(!0)}function clearHistoy(){clearConsoleMemo(),logConsoleMemo()}function openMemory(){$("#memwind").css("display","block")}function closeMemory(){$("#memwind").css("display","none")}function openBitSwitcher(){$("#binwind").css("display","block")}function closeBitSwitcher(){$("#binwind").css("display","none")}function addCurrentToMem(){memoryNumbers.push({dec:state.curdec,hex:state.curhex,bin:state.curbin}),updateMemory()}function executeCommand(t){if(addCmdToLog(t,!0),"bak"==t){var e=state["cur"+state.input];e=e.substring(0,e.length-1),setCurrent(e,state.base)}else if("plm"==t){var e=state.numberX.negate().toString(10);setCurrent(e,10)}else if("rol"==t){var e=state.curbin;setCurrent(rotateBinary(e,"l"),2)}else if("ror"==t){var e=state.curbin;setCurrent(rotateBinary(e,"r"),2)}else if("rsh"==t){var e=state.curbin;e=e.substring(0,e.length-1),setCurrent(e,2)}else if("lsh"==t){var e=state.curbin;e+="0",setCurrent(e,2)}else if("not"==t){for(var e=state.curbin,s=e.length,n="",a=0;s>a;a++)n+="0"==e.charAt(a)?"1":"0";s=state.bitlength-e.length;for(var a=0;s>a;a++)n="1"+n;setCurrent(n,2)}1==state.isfloat,updateNumfields()}function stackCommand(t){addCmdToLog(t,!1),""!=state.curcmd&&equall(),state.curcmd=t,state.numberX.copyTo(state.operandA),state.foperandA=state.foperandA.clone(state.fnumberX),setCurrent("0",10)}function addCmdToLog(t,e){{var s=console_memo[console_memo.length-1].type;console_memo[console_memo.length-1]}"cmd"==s?e?console_memo[console_memo.length-1].oncurrent?(console_memo.push({type:"eq",value:"="}),console_memo.push({type:"cmd",value:t,oncurrent:e})):console_memo.push({type:"cmd",value:t,oncurrent:e}):console_memo[console_memo.length-1].oncurrent?console_memo.push({type:"cmd",value:t,oncurrent:e}):console_memo[console_memo.length-1]={type:"cmd",value:t,oncurrent:e}:console_memo.push(e?{type:"cmd",value:t,oncurrent:e}:{type:"cmd",value:t,oncurrent:e})}function clearConsoleMemo(){console_memo=[{type:"eq",value:"="},{type:state.input,value:state["cur"+state.input]}]}function logConsoleMemo(){var t=[];for(i=0;i<console_memo.length;i++){var e=console_memo[i];if("eq"==e.type);else if("cmd"==e.type)if(e.oncurrent)if("eq"!=console_memo[i-1].type)switch(e.value){case"plm":t[t.length-1]="-("+t[t.length-1]+")";break;case"rol":t[t.length-1]="ROL("+t[t.length-1]+")";break;case"ror":t[t.length-1]="ROR("+t[t.length-1]+")";break;case"lsh":t[t.length-1]="LShift("+t[t.length-1]+")";break;case"rsh":t[t.length-1]="RShift("+t[t.length-1]+")";break;case"not":t[t.length-1]="NOT("+t[t.length-1]+")"}else switch(e.value){case"plm":t.unshift("-("),t.push(")");break;case"rol":t.unshift("ROL("),t.push(")");break;case"ror":t.unshift("ROR("),t.push(")");break;case"lsh":t.unshift("LShift("),t.push(")");break;case"rsh":t.unshift("RShift("),t.push(")");break;case"not":t.unshift("NOT("),t.push(")")}else switch(e.value){case"mod":t.unshift("("),t.push(") mod ");break;case"xly":t.unshift("("),t.push(") << ");break;case"xry":t.unshift("("),t.push(") >> ");break;case"and":t.unshift("("),t.push(") and  ");break;case"or":t.unshift("("),t.push(") or ");break;case"xor":t.unshift("("),t.push(") xor ");break;case"nnd":t.unshift("("),t.push(") nand ");break;case"nor":t.unshift("("),t.push(") nor ");break;case"xnr":t.unshift("("),t.push(") xnor ");break;case"div":t.unshift("("),t.push(")/");break;case"mul":t.unshift("("),t.push(")*");break;case"dif":t.push(" - ");break;case"plu":t.push(" + ")}else("hex"==e.type||"dec"==e.type||"bin"==e.type)&&t.push("<font class='color_"+e.type+"' >"+e.value.toUpperCase()+"</font><span class='dec_index'>"+e.type+"</span>")}return $("#console_log").html(t.join("")),t.join("")}function equall(){if(""!=state.curcmd){var t=state.curcmd;state.prevcmd=t,state.curcmd="",state.numberX.copyTo(state.operandB),1==state.isfloat&&(state.foperandB=state.foperandB.clone(state.fnumberX))}else var t=state.prevcmd;var e;"mod"==t?(e=state.operandA.mod(state.operandB),e.copyTo(state.operandA),setCurrent(e.toString(10),10),updateNumfields()):"xly"==t?(e=state.operandA.shiftLeft(state.operandB),e.copyTo(state.operandA),setCurrent(e.toString(10),10),updateNumfields()):"xry"==t?(e=state.operandA.shiftRight(state.operandB),e.copyTo(state.operandA),setCurrent(e.toString(10),10),updateNumfields()):"and"==t?(e=state.operandA.and(state.operandB),e.copyTo(state.operandA),setCurrent(e.toString(10),10),updateNumfields()):"or"==t?(e=state.operandA.or(state.operandB),e.copyTo(state.operandA),setCurrent(e.toString(10),10),updateNumfields()):"xor"==t?(e=state.operandA.xor(state.operandB),e.copyTo(state.operandA),setCurrent(e.toString(10),10),updateNumfields()):"nnd"==t?(e=state.operandA.andNot(state.operandB),e.copyTo(state.operandA),setCurrent(e.toString(10),10),updateNumfields()):"nor"==t?(e=state.operandA.or(state.operandB),e.fromString(invertBinary(e.toString(2)),2),e.copyTo(state.operandA),setCurrent(e.toString(10),10),updateNumfields()):"xnr"==t?(e=state.operandA.xor(state.operandB),e.fromString(invertBinary(e.toString(2)),2),e.copyTo(state.operandA),setCurrent(e.toString(10),10),updateNumfields()):"div"==t?(1==state.isfloat?(e=state.foperandA.divide(state.foperandB),setCurrent(e.toString(),1)):(e=state.operandA.divide(state.operandB),e.copyTo(state.operandA),setCurrent(e.toString(10),10)),updateNumfields()):"mul"==t?(1==state.isfloat?(e=state.foperandA.multiply(state.foperandB),setCurrent(e.toString(),1)):(e=state.operandA.multiply(state.operandB),e.copyTo(state.operandA),setCurrent(e.toString(10),10)),updateNumfields()):"dif"==t?(1==state.isfloat?(e=state.foperandA.subtract(state.foperandB),setCurrent(e.toString(),1)):(e=state.operandA.subtract(state.operandB),e.copyTo(state.operandA),setCurrent(e.toString(10),10)),updateNumfields()):"plu"==t?(1==state.isfloat?(e=state.foperandA.add(state.foperandB),setCurrent(e.toString(),1)):(e=state.operandA.add(state.operandB),e.copyTo(state.operandA),setCurrent(e.toString(10),10)),updateNumfields()):""==t&&(1==state.isfloat||(e=state.numberX,setCurrent(e.toString(10),10),updateNumfields())),"eq"!=console_memo[console_memo.length-1].type&&("cmd"==console_memo[console_memo.length-1].type?console_memo[console_memo.length-1].oncurrent&&console_memo.push({type:"eq",value:"="}):console_memo.push({type:"eq",value:"="}))}function invertBinary(t){for(var e=t.length,s="",n=0;e>n;n++)s+="0"==t.charAt(n)?"1":"0";for(e=state.bitlength-t.length,n=0;e>n;n++)s="1"+s;return s}function rotateBinary(t,e){for(var s=state.bitlength-t.length,n=t,a=0;s>a;a++)n="0"+n;return"l"==e?n=n.substr(1)+n.substr(0,1):"r"==e&&(n=n.substr(-1)+n.substr(0,n.length-1)),n}function updateNumfields(){if(100==state.numberX.signum()){var t=state.curdec;if(""!=t){var e=t.replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,");$("#textfield_dec").html(e)}}else{var t=state.curdec;if(""!=t){var e=t.replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,");$("#textfield_dec").html(e)}}var s=state.curhex;if(""!=s){for(var n=state.bitlength/4-s.length,a='<font class="color_gray">',i=0;n>i;i++)a+="0";a+="</font>",$("#textfield_hex").html(a+s.toUpperCase());var i,r=s.length,o=state.bitlength/4;for(i=0;16>i;i++)$("#textfield_bin_"+i).html(o>i?"<font>0000</font>":'<font class="color_gray">0000</font>');for(i=0;r>i;i++){var c=parseInt(s.charAt(r-i-1),16),l=c.toString(2);1==l.length&&(l="000"+l),2==l.length&&(l="00"+l),3==l.length&&(l="0"+l),$("#textfield_bin_"+i).html("<u>"+l+"</u>")}var u="";for(i=r;i>0;i-=2){var d=s.substring(i-2,i);acsii_hex["hex_"+d]&&(u=acsii_hex["hex_"+d].html+u)}$("#textfield_ascii").html(u);var p=$(".bitswitch_btn > .bitswitch_glyph");for(r=p.length,i=0;r>i;i++){var m=$("#bitswbtn"+i+" > .bitswitch_glyph")[0];if(i<state.curbin.length){var h=state.curbin.charAt(state.curbin.length-i-1);$(m).html(h),$(m).css("opacity","1")}else $(m).html("0"),$(m).css("opacity","0.5")}$("#inp_switcher_txt").html("<font class='color_"+state.input+" txt_shad'>"+state.input+"</font>")}if(1==state.isfloat){var g=state.curdec,b=g.split("e");$("#textfield_dec").html(b.length>1?b[0]+'<span class="power">'+parseInt(b[1])+"</span>":b[0])}var g=state.curfloat,b=g.split("e");$("#textfield_float").html(b.length>1?b[0]+'<span class="power">'+parseInt(b[1])+"</span>":b[0])}function updateMemory(){for($("#memlines").html(""),i=0;i<memoryNumbers.length;i++){var t=$('<div class="memline" id="memline_'+i+'"/>').appendTo("#memlines");t.append('<span class="color_dec">'+memoryNumbers[i].dec+" </span>"),t.append('<span class="color_hex">'+memoryNumbers[i].hex+"</span></br>"),t.append('<span class="color_bin">'+memoryNumbers[i].bin+"</span>"),$("#memline_"+i).on(END_EVENT,function(t){setMemFromId(t.currentTarget.id)})}}function setMemFromId(t){var e=t.split("_")[1];setCurrent(memoryNumbers[parseInt(e)].dec.toString(),10),updateNumfields(),closeMemory()}function setCurrent(t,e){if(e>1){t=t.toString(),state.numberX.fromString(t,e);var s=state.numberX.toString(2).length;if(s>state.bitlength){var n=state.numberX.toString(2);state.numberX.fromString(n.substr(-state.bitlength),2)}if(state.numberX.signum()>-1)if(state.curdec=state.numberX.toString(10),state.curhex=state.numberX.toString(16),state.curbin=state.numberX.toString(2),1==state.signed)if(state.numberX.toString(2).length==state.bitlength){var a=new BigInteger("-"+invertBinary(state.numberX.toString(2)),2);a=a.subtract(new BigInteger("1",10)),state.curdec=a.toString(10),state.curhex=state.numberX.toString(16),state.curbin=state.numberX.toString(2)}else state.curdec=state.numberX.toString(10),state.curhex=state.numberX.toString(16),state.curbin=state.numberX.toString(2);else state.curdec=state.numberX.toString(10),state.curhex=state.numberX.toString(16),state.curbin=state.numberX.toString(2);else{var a=state.numberX.abs();a=a.subtract(new BigInteger("1",10)),a.fromString(invertBinary(a.toString(2)),2),state.curhex=a.toString(16),state.curbin=a.toString(2),state.curdec=1==state.signed?state.numberX.toString(10):a.toString(10)}if(state.curbin.length<state.bitlength)for(var i=state.bitlength;i>state.curbin.length;i--)state.curbin="0"+state.curbin;if(8!=state.bitlength){state.floatHex.fromString(state.curhex,16);var r=state.floatHex.toString();state.curfloat=getFloat(r,state.bitlength,!1),state.fnumberX=0==isNaN(state.curfloat)?new BigDecimal(state.curfloat):"Infinity",1==state.isfloat&&(state.curdec=state.fnumberX.toString())}else state.curfloat="-"}else if(8!=state.bitlength){var o=encodeFloat(t,state.bitlength);state.fnumberX=new BigDecimal(t),state.numberX.fromString(o,2),state.curdec=state.numberX.toString(10),state.curhex=state.numberX.toString(16),state.curbin=state.numberX.toString(2),state.curdec=state.fnumberX.toString(),state.floatHex.fromString(state.curhex,16);var r=state.floatHex.toString();state.curfloat=getFloat(r,state.bitlength,!1)}else state.curfloat="-"}function setInput(t){switch(t){case"hex":$(".nbs_hex").removeClass("color_gray"),$(".nbs_dec").removeClass("color_gray"),state.base=16;break;case"dec":$(".nbs_hex").addClass("color_gray"),$(".nbs_dec").removeClass("color_gray"),state.base=10;break;case"bin":$(".nbs_hex").addClass("color_gray"),$(".nbs_dec").addClass("color_gray"),state.base=2}state.input=t}function switchSigned(t){0==t?($("#sign_switcher").css("background-position","0px 0px"),$("#sign_switcher").css("text-align","left"),$("#sign_switcher_txt").html("Unsigned")):($("#sign_switcher").css("background-position","0px 0px"),$("#sign_switcher").css("text-align","left"),$("#sign_switcher_txt").html("Signed")),state.signed=t,setCurrent(state.curhex,16),updateNumfields()}function switchNumType(t){0==t?(state.signed=!0,state.isfloat=!1,setCurrent(state.curhex,16)):1==t?(state.signed=!1,state.isfloat=!1,setCurrent(state.curhex,16)):2==t&&(state.isfloat=!0,state.signed=!1,setCurrent(state.curdec,1)),$("#type_switcher_txt").html(available_types[t]),updateNumfields(),checkFloatHint()}function switchBitlenght(t){t>=0&&t<available_bits.length&&(state.bitlength=available_bits[t]),setCurrent(state.curbin,2),$("#bit_switcher_txt").html(available_bits[t]+" bit"),16==state.bitlength?($("#typelist_element_2").css("display","block"),available_types[2]="Half",$("#typelist_element_2").html("Half")):32==state.bitlength?($("#typelist_element_2").css("display","block"),available_types[2]="Single",$("#typelist_element_2").html("Single")):64==state.bitlength?($("#typelist_element_2").css("display","block"),available_types[2]="Double",$("#typelist_element_2").html("Double")):12==state.bitlength?($("#typelist_element_2").css("display","block"),available_types[2]="Quadruple",$("#typelist_element_2").html("Quadruple")):($("#typelist_element_2").css("display","none"),$("#typelist_element_2").html(" - ")),1==state.isfloat&&$("#type_switcher_txt").html($("#typelist_element_2").html()),updateNumfields(),checkFloatHint()}function switchInpType(t){t>=0&&t<available_inps.length&&setInput(available_inps[t]),updateNumfields(),$("#inp_switcher_txt").html("<font class='color_"+state.input+" txt_shad'>"+state.input+"</font>")}function switchTypeType(t){t>=0&&t<available_types.length&&switchNumType(t),updateNumfields(),$("#type_switcher_txt").html(available_types[t])}function getParameterByName(t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var e=new RegExp("[\\?&]"+t+"=([^&#]*)"),s=e.exec(location.search);return null==s?"":decodeURIComponent(s[1].replace(/\+/g," "))}function getShareURL(){var t="";return""!=state.cmdURL&&(t="?s="+state.cmdURL),"http://"+window.location.host+window.location.pathname+t}function getFloat(t,e,s){if(8!=e)var n=binparser.encodeInt(t,e,s);var a=0;return 16==e?a=binparser.decodeFloat(n,10,5).toString():32==e?a=binparser.decodeFloat(n,23,8).toString():64==e?a=binparser.decodeFloat(n,52,11).toString():128==e?a=binparser.decodeFloat(n,112,15).toString():alert("sorry there is no IEEE  for this"),a}function encodeFloat(t,e){var s=0;16==e?s=binparser.encodeFloat(t,10,5).toString():32==e?s=binparser.encodeFloat(t,23,8).toString():64==e?s=binparser.encodeFloat(t,52,11).toString():128==e?s=binparser.encodeFloat(t,112,15).toString():alert("sorry there is no IEEE  for this");for(var n="",a=0;a<s.length;a++){var i=s.charCodeAt(a).toString(2),r=8-i.length;i=new Array(r+1).join("0")+i,n+=i}return n}var calcwidth,calcheight,isTouchSupported,START_EVENT,MOVE_EVENT,END_EVENT,memoryNumbers=[],binparser=new BinaryParser(!0),btn_images={idle:"",press:"",p_idle:"",p_press:"",e_idle:"",e_press:""},available_bits=[8,16,32,64,128],available_inps=["hex","dec","bin"],available_types=["Signed","Unsigned","Double"],console_memo=[{type:"eq",value:""}],globalstr="",state={input:"hex",base:16,bitlength:64,numberX:new BigInteger("0",10),operandA:new BigInteger("0",10),operandB:new BigInteger("0",10),fnumberX:new BigDecimal("0.0"),foperandA:new BigDecimal("0.0"),foperandB:new BigDecimal("0.0"),floatHex:new BigInteger("0",10),signed:!0,isfloat:!1,curdec:"0",curhex:"0",curbin:"0",curfloat:"0",fakefloat:"0",curcmd:"",prevcmd:"",bitSelect:!1,inpSelect:!1,typeSelect:!1,cmdURL:"",cmdURLBak:"",undosteps:0};